<?xml version="1.0" encoding="UTF-8" ?>

<schema name="UBO Schema" version="1.5">

  <!-- SOLR internal fields -->
  <field name="_version_" type="long"   indexed="true" stored="true"  />
  <field name="_root_"    type="string" indexed="true" stored="false" />

  <!-- MyCoRe general fields -->
  <field name="id"            type="string" indexed="true" stored="true"  required="true"  multiValued="false" />
  <field name="returnId"      type="string" indexed="true" stored="true"  required="false" multiValued="false" />
  <field name="objectType"    type="string" indexed="true" stored="false" required="false" multiValued="false" />
  <field name="objectProject" type="string" indexed="true" stored="false" required="false" multiValued="false" />

  <!-- UniversitÃ¤tsbibliographie fields -->
  <field name="title"      type="text"   indexed="true" stored="true"  multiValued="true"  />
  <field name="genre"      type="string" indexed="true" stored="true"  multiValued="false" />
  <field name="subject"    type="string" indexed="true" stored="true"  multiValued="true"  />
  <field name="origin"     type="string" indexed="true" stored="false" multiValued="true"  />
  <field name="status"     type="string" indexed="true" stored="false" multiValued="false" />
  <field name="journal"    type="name"   indexed="true" stored="false" multiValued="true"  />
  <field name="series"     type="name"   indexed="true" stored="false" multiValued="true"  />
  <field name="conference" type="name"   indexed="true" stored="false" multiValued="false" />
  <field name="year"       type="int"    indexed="true" stored="true"  multiValued="false" />
  <field name="lang"       type="string" indexed="true" stored="false" multiValued="true"  />
  <field name="tag"        type="string" indexed="true" stored="false" multiValued="true"  />
  <field name="dedup"      type="string" indexed="true" stored="false" multiValued="true"  />

  <!-- Fields for mods:identifier, e.g. <mods:identifier type="doi" /> -> id_doi -->
  <dynamicField name="id_*"  type="id" indexed="true" stored="false" multiValued="true" />
  
  <!-- Fields for mods:nameIdentifier, e.g. <mods:nameIdentifier type="scopus" /> -> nid_scopus -->
  <dynamicField name="nid_*" type="id" indexed="true" stored="false" multiValued="true" />

  <!-- Ignore all other fields -->
  <dynamicField name="*" type="ignored" />

  <uniqueKey>id</uniqueKey>

  <fieldType name="string"  class="solr.StrField"      sortMissingLast="true" />
  <fieldType name="int"     class="solr.TrieIntField"  precisionStep="0" positionIncrementGap="0"/>
  <fieldType name="long"    class="solr.TrieLongField" precisionStep="0" positionIncrementGap="0" />
  <fieldtype name="ignored" class="solr.StrField"      stored="false" indexed="false" multiValued="true"  />

  <!-- Field type for identifiers such as ISBN, ISSN: remove hyphens -->
  <fieldType name="id" class="solr.TextField">
    <analyzer type="index">
      <tokenizer class="solr.WhitespaceTokenizerFactory" />
      <filter class="solr.PatternReplaceFilterFactory" pattern="-" replacement="" replace="all" />
      <filter class="solr.LowerCaseFilterFactory" />
    </analyzer>
    <analyzer type="query">
      <tokenizer class="solr.WhitespaceTokenizerFactory" />
      <filter class="solr.PatternReplaceFilterFactory" pattern="-" replacement="" replace="all" />
      <filter class="solr.LowerCaseFilterFactory" />
    </analyzer>
  </fieldType>

  <!-- Field type for text such as title, abstract, comment -->
  <fieldType name="text" class="solr.TextField" positionIncrementGap="100">
    <analyzer type="index">
      <charFilter class="solr.MappingCharFilterFactory" mapping="mapping-ISOLatin1Accent.txt"/>
      <tokenizer class="solr.StandardTokenizerFactory" />
      <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt" />
      <filter class="solr.GermanNormalizationFilterFactory"/>
      <filter class="solr.ICUNormalizer2FilterFactory" name="nfkc_cf" mode="compose"/>
    </analyzer>
    <analyzer type="query">
      <charFilter class="solr.MappingCharFilterFactory" mapping="mapping-ISOLatin1Accent.txt"/>
      <tokenizer class="solr.StandardTokenizerFactory" />
      <filter class="solr.SynonymFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="true" />
      <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt" />
      <filter class="solr.GermanNormalizationFilterFactory"/>
      <filter class="solr.ICUNormalizer2FilterFactory" name="nfkc_cf" mode="compose"/>
    </analyzer>
  </fieldType>

  <!-- Field type for names such as author, editor, place -->
  <fieldType name="name" class="solr.TextField" positionIncrementGap="100">
    <analyzer type="index">
      <charFilter class="solr.MappingCharFilterFactory" mapping="mapping-ISOLatin1Accent.txt"/>
      <tokenizer class="solr.StandardTokenizerFactory" />
      <filter class="solr.GermanNormalizationFilterFactory"/>
      <filter class="solr.ICUNormalizer2FilterFactory" name="nfkc_cf" mode="compose"/>
    </analyzer>
    <analyzer type="query">
      <charFilter class="solr.MappingCharFilterFactory" mapping="mapping-ISOLatin1Accent.txt"/>
      <tokenizer class="solr.StandardTokenizerFactory" />
      <filter class="solr.GermanNormalizationFilterFactory"/>
      <filter class="solr.ICUNormalizer2FilterFactory" name="nfkc_cf" mode="compose"/>
    </analyzer>
  </fieldType>
  
</schema>
